"use strict";(self.webpackChunktaskforce_frontend=self.webpackChunktaskforce_frontend||[]).push([[637],{637:(e,s,a)=>{a.r(s),a.d(s,{default:()=>P});var l=a(555),t=a(43),n=a(60),o=a(742),r=a(178),i=a(759),c=a(579);const d=e=>{let{task:s,onShowDeleteModal:a,onEditTask:l,onAssignTask:t,currentUserRole:n,onShowTaskDetail:o}=e;return(0,c.jsxs)("div",{className:"task-card",draggable:!0,onDragStart:e=>{e.dataTransfer.setData("taskId",s.id)},onClick:()=>o(s),children:[(0,c.jsxs)("div",{className:"task-header",children:[(0,c.jsx)("h4",{className:"task-title",children:s.title}),(0,c.jsxs)("div",{className:"task-actions",children:[!s.assignedTo&&i.A.canAccessAdmin(n)&&(0,c.jsx)("button",{className:"btn-assign",onClick:e=>{e.stopPropagation(),t(s.id)},"aria-label":"Assigner automatiquement cette t\xe2che",title:"Assigner automatiquement",children:(0,c.jsx)("span",{"aria-hidden":"true",children:"\ud83c\udfaf"})}),i.A.canModifyTasks(n)&&(0,c.jsx)("button",{className:"btn-edit",onClick:e=>{e.stopPropagation(),l(s)},"aria-label":"Modifier cette t\xe2che",title:"Modifier la t\xe2che",children:(0,c.jsx)("span",{"aria-hidden":"true",children:"\u270f\ufe0f"})}),i.A.canModifyTasks(n)&&(0,c.jsx)("button",{className:"btn-delete",onClick:e=>{e.stopPropagation(),a(s)},"aria-label":"Supprimer cette t\xe2che",title:"Supprimer la t\xe2che",children:(0,c.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]})]}),s.description&&(0,c.jsx)("p",{className:"task-description",children:s.description.length>100?"".concat(s.description.substring(0,100),"..."):s.description}),(0,c.jsxs)("div",{className:"task-meta",children:[(0,c.jsx)("div",{className:"task-priority",children:(0,c.jsx)("span",{className:"priority-badge",style:{backgroundColor:(e=>{switch(e){case"high":return"#ef4444";case"medium":return"#f59e0b";case"low":return"#10b981";default:return"#6b7280"}})(s.priority)},children:(e=>{switch(e){case"high":return"Haute";case"medium":return"Moyenne";case"low":return"Basse";default:return"Non d\xe9finie"}})(s.priority)})}),(0,c.jsx)("div",{className:"task-info",children:(0,c.jsx)("span",{className:"task-date",children:(r=s.createdAt,new Date(r).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}))})})]}),s.assignedTo&&(0,c.jsxs)("div",{className:"task-assignee",children:[(0,c.jsx)("span",{className:"assignee-label",children:"Assign\xe9 \xe0 :"}),(0,c.jsxs)("span",{className:"assignee-name",children:[s.assignedTo.firstname," ",s.assignedTo.lastname]})]}),s.requiredSkills&&s.requiredSkills.length>0&&(0,c.jsx)("div",{className:"task-skills",children:s.requiredSkills.map((e=>(0,c.jsx)("span",{className:"skill-tag",children:e.name},e.id)))})]});var r},m=e=>{let{column:s,tasks:a,onUpdateTaskStatus:l,onDeleteTask:n,onShowDeleteModal:o,onAddSkills:r,onEditTask:i,onAssignTask:m,currentUserRole:u,onReorder:h,onShowTaskDetail:j}=e;const[p,x]=(0,t.useState)(!1),[v,C]=(0,t.useState)(!1);return(0,c.jsxs)("div",{className:"task-column ".concat(p?"dragging":""," ").concat(v?"drag-over":""),onDragOver:e=>{e.preventDefault()},onDrop:e=>{e.preventDefault();const a=e.dataTransfer.getData("taskId");a&&l(parseInt(a),s.identifier)},children:[(0,c.jsxs)("div",{className:"column-header ".concat(p?"dragging":""),style:{borderTopColor:s.color},draggable:!0,onDragStart:e=>{e.dataTransfer.setData("columnId",String(s.id)),e.dataTransfer.effectAllowed="move",x(!0)},onDragEnd:e=>{x(!1)},onDragOver:e=>{e.preventDefault(),e.dataTransfer.dropEffect="move",C(!0)},onDragLeave:e=>{e.currentTarget.contains(e.relatedTarget)||C(!1)},onDrop:e=>{e.preventDefault(),e.stopPropagation(),C(!1);const a=e.dataTransfer.getData("columnId");if(!e.dataTransfer.getData("taskId")&&a&&h){const e=parseInt(a);Number.isNaN(e)||e===s.id||h(e,s.id)}},title:"Glisser pour r\xe9organiser la colonne",children:[(0,c.jsxs)("div",{className:"column-title",children:[(0,c.jsx)("h3",{children:s.name}),(0,c.jsx)("span",{className:"task-count",children:a.length})]}),(0,c.jsx)("p",{className:"column-description",children:s.description})]}),(0,c.jsx)("div",{className:"column-content",children:0===a.length?(0,c.jsx)("div",{className:"empty-column",children:(0,c.jsx)("p",{children:"Aucune t\xe2che"})}):a.map((e=>(0,c.jsx)(d,{task:e,onDeleteTask:n,onShowDeleteModal:o,onAddSkills:r,onEditTask:i,onAssignTask:m,currentUserRole:u,onShowTaskDetail:j},e.id)))})]})},u=e=>{let{columns:s,tasks:a,onUpdateTaskStatus:l,onDeleteTask:t,onShowDeleteModal:n,onAddSkills:o,onEditTask:r,onAssignTask:i,currentUserRole:d,onReorderColumns:u,onShowTaskDetail:h}=e;const j=e=>a.filter((s=>{var a;return(null===(a=s.column)||void 0===a?void 0:a.id)===e.id||s.status===e.identifier}));return(0,c.jsx)("div",{className:"kanban-board",children:(0,c.jsx)("div",{className:"kanban-columns",children:s.map((e=>(0,c.jsx)(m,{column:e,tasks:j(e),onUpdateTaskStatus:l,onDeleteTask:t,onShowDeleteModal:n,onAddSkills:o,onEditTask:r,onAssignTask:i,currentUserRole:d,onReorder:u,onShowTaskDetail:h},e.id)))})})},h=e=>{let{selectedProject:s,currentUserRole:a,showColumnActionsMenu:l,setShowColumnActionsMenu:t,setShowCreateColumn:n,setShowSelectColumnToEditModal:o,setShowSelectColumnToDeleteModal:r,setShowDeleteProjectModal:i,setShowCreateTask:d,setShowDescriptionModal:m,handleAssignAllTasks:u,isManager:h,canDeleteColumns:j,canDeleteProject:p,canCreateTasks:x,canAssignTasks:v}=e;return s?(0,c.jsxs)("div",{className:"kanban-header",children:[(0,c.jsxs)("div",{className:"project-info-header",children:[(0,c.jsx)("h1",{className:s.name.length>50?"clickable-title":"",onClick:()=>{s.name.length>50&&m(!0)},title:s.name.length>50?"Cliquer pour voir le titre complet":"",children:s.name.length>50?s.name.substring(0,50)+"...":s.name}),s.description&&(0,c.jsx)("p",{className:s.description.length>100?"clickable-description":"",onClick:()=>{s.description&&s.description.length>100&&m(!0)},title:s.description&&s.description.length>100?"Cliquer pour voir la description compl\xe8te":"",children:s.description}),a&&(0,c.jsx)("div",{className:"current-user-role",children:(0,c.jsx)("span",{className:"role-indicator",children:a})})]}),(0,c.jsxs)("div",{className:"kanban-actions",children:[j(a)&&(0,c.jsxs)("div",{className:"column-actions-dropdown",children:[(0,c.jsx)("button",{className:"btn-column-actions",onClick:()=>t(!l),children:"\u22ee G\xe9rer les Colonnes"}),l&&(0,c.jsxs)("div",{className:"column-actions-menu",children:[(0,c.jsx)("button",{className:"menu-item add-column",onClick:()=>{n(!0),t(!1)},children:"Nouvelle Colonne"}),(0,c.jsx)("button",{className:"menu-item edit-columns",onClick:()=>{t(!1),o(!0)},children:"Modifier une Colonne"}),(0,c.jsx)("button",{className:"menu-item delete-columns",onClick:()=>{t(!1),r(!0)},children:"Supprimer une Colonne"})]})]}),v(a)&&(0,c.jsx)("button",{className:"btn-assign-all",onClick:u,title:"Assigner automatiquement toutes les t\xe2ches non assign\xe9es",children:"Assigner Toutes"}),p(a)&&(0,c.jsx)("button",{className:"btn-delete-project",onClick:()=>i(!0),title:"Seuls les responsables de projet peuvent supprimer des projets",children:"Supprimer Projet"}),x(a)&&(0,c.jsx)("button",{className:"btn-create-task",onClick:()=>d(!0),title:"Cr\xe9er une nouvelle t\xe2che",children:"+ Nouvelle T\xe2che"})]})]}):(0,c.jsxs)("div",{className:"no-project-selected",children:[(0,c.jsx)("h2",{children:"Bienvenue sur TaskForce"}),(0,c.jsx)("p",{children:"Veuillez s\xe9lectionner un projet pour commencer"})]})},j=e=>{let{sidebarOpen:s,setSidebarOpen:l,projects:t,selectedProject:n,setSelectedProject:o,setShowCreateProject:r,isCreator:i}=e;return(0,c.jsx)("div",{className:"sidebar ".concat(s?"open":"closed"),children:s?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"sidebar-header",children:[(0,c.jsx)("h2",{children:"Mes Projets"}),(0,c.jsx)("button",{className:"sidebar-toggle",onClick:()=>l(!1),children:"\u25c0"})]}),(0,c.jsxs)("div",{className:"sidebar-content",children:[(0,c.jsx)("button",{className:"btn-create-project-sidebar",onClick:()=>r(!0),children:"+ Nouveau Projet"}),(0,c.jsx)("div",{className:"projects-list",children:t.map((e=>(0,c.jsx)("div",{className:"project-item ".concat((null===n||void 0===n?void 0:n.id)===e.id?"active":""),onClick:()=>o(e),children:(0,c.jsxs)("div",{className:"project-info",children:[(0,c.jsx)("h3",{children:e.name}),(0,c.jsx)("p",{children:e.description||"Aucune description"}),(0,c.jsxs)("small",{children:[e.taskCount," t\xe2ches"]})]})},e.id)))})]})]}):(0,c.jsx)("div",{className:"sidebar-closed",children:(0,c.jsx)("button",{className:"sidebar-toggle-closed",onClick:()=>l(!0),title:"Ouvrir la liste des projets",children:(0,c.jsx)("img",{src:a(850),alt:"Ouvrir la liste des projets",className:"sidebar-toggle-icon"})})})})};var p=a(987),x=a(367);const v=e=>{let{onClose:s,onCreateProject:a}=e;const[n,o]=(0,t.useState)({name:"",description:""}),[r,i]=(0,t.useState)({}),d=e=>{const{name:s,value:a}=e.target;"name"===s&&a.length>50||(o((e=>(0,l.A)((0,l.A)({},e),{},{[s]:a}))),r[s]&&i((e=>(0,l.A)((0,l.A)({},e),{},{[s]:""}))))};return(0,c.jsx)("div",{className:"modal-overlay",onClick:s,children:(0,c.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{className:"modal-header",children:[(0,c.jsx)("h2",{children:"Cr\xe9er un nouveau projet"}),(0,c.jsx)("button",{className:"btn-close",onClick:s,children:"\xd7"})]}),(0,c.jsxs)("form",{onSubmit:e=>{e.preventDefault(),i({}),n.name.trim()?n.name.length>50?i({name:"Le nom du projet ne peut pas d\xe9passer 50 caract\xe8res"}):a(n):i({name:"Le nom du projet est requis"})},className:"modal-form",children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"name",children:"Nom du projet *"}),(0,c.jsx)("input",{type:"text",id:"name",name:"name",value:n.name,onChange:d,placeholder:"Nom du projet (max 50 caract\xe8res)",maxLength:50,required:!0,className:r.name?"error":""}),(0,c.jsxs)("div",{className:"char-counter",children:[n.name.length,"/50"]}),r.name&&(0,c.jsx)("div",{className:"error-message",children:r.name})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"description",children:"Description"}),(0,c.jsx)("textarea",{id:"description",name:"description",value:n.description,onChange:d,placeholder:"Description du projet",rows:"4"})]}),(0,c.jsxs)("div",{className:"modal-actions",children:[(0,c.jsx)("button",{type:"button",className:"btn-cancel",onClick:s,children:"Annuler"}),(0,c.jsx)("button",{type:"submit",className:"btn-create",children:"Cr\xe9er le projet"})]})]})]})})},C=e=>{let{onClose:s,onConfirm:a,project:l}=e;return(0,c.jsx)("div",{className:"delete-modal-overlay",onClick:s,children:(0,c.jsxs)("div",{className:"delete-modal",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{className:"delete-modal-header",children:[(0,c.jsx)("h3",{children:"Confirmerr la suppression"}),(0,c.jsx)("button",{className:"modal-close",onClick:s,children:"\xd7"})]}),(0,c.jsxs)("div",{className:"delete-modal-body",children:[(0,c.jsxs)("p",{children:["\xcates-vous s\xfbr de vouloir supprimer le projet ",(0,c.jsx)("strong",{children:l.name})," ?"]}),(0,c.jsx)("p",{className:"warning",children:"Cette action est irr\xe9versible et supprimera tout."})]}),(0,c.jsxs)("div",{className:"delete-modal-footer",children:[(0,c.jsx)("button",{className:"btn-secondary",onClick:s,children:"Annuler"}),(0,c.jsx)("button",{className:"btn-danger",onClick:a,children:"Supprimer d\xe9finitivement"})]})]})})},N=e=>{let{onClose:s,onCreateColumn:a}=e;const[n,o]=(0,t.useState)({name:"",description:"",color:"#6b7280"}),r=e=>{const{name:s,value:a}=e.target;o((e=>(0,l.A)((0,l.A)({},e),{},{[s]:a})))};return(0,c.jsx)("div",{className:"modal-overlay",onClick:s,children:(0,c.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{className:"modal-header",children:[(0,c.jsx)("h2",{children:"Cr\xe9er une nouvelle colonne"}),(0,c.jsx)("button",{className:"btn-close",onClick:s,children:"\xd7"})]}),(0,c.jsxs)("form",{className:"modal-form",onSubmit:e=>{e.preventDefault(),n.name.trim()&&a(n)},children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"name",children:"Nom de la colonne *"}),(0,c.jsx)("input",{type:"text",id:"name",name:"name",value:n.name,onChange:r,placeholder:"Ex: En cours, Termin\xe9...",required:!0})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"description",children:"Description"}),(0,c.jsx)("textarea",{id:"description",name:"description",value:n.description,onChange:r,placeholder:"Description de la colonne..."})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"color",children:"Couleur"}),(0,c.jsx)("input",{type:"color",id:"color",name:"color",value:n.color,onChange:r})]}),(0,c.jsxs)("div",{className:"modal-actions",children:[(0,c.jsx)("button",{type:"button",className:"btn-cancel",onClick:s,children:"Annuler"}),(0,c.jsx)("button",{type:"submit",className:"btn-create",children:"Cr\xe9er la colonne"})]})]})]})})};var k=a(202);const g=e=>{let{onClose:s,project:a,onUserUpdated:n}=e;const[o,r]=(0,t.useState)([]),[i,d]=(0,t.useState)(!1),[m,u]=(0,t.useState)(null),[h,j]=(0,t.useState)(""),[p,x]=(0,t.useState)(null),[v,C]=(0,t.useState)(!1),[N,g]=(0,t.useState)(""),[b,S]=(0,t.useState)("collaborateur"),[w,f]=(0,t.useState)([]),[T,y]=(0,t.useState)(!1);(0,t.useEffect)((()=>{if(a){var e;r(a.users||[]);const s=JSON.parse(localStorage.getItem("user")),l=null===(e=a.users)||void 0===e?void 0:e.find((e=>e.id===s.id));x(null===l||void 0===l?void 0:l.role)}}),[a]),(0,t.useEffect)((()=>{v&&D()}),[v]);const D=async()=>{try{const e=await k.dashboardServices.getUsers();f(e.users)}catch(e){console.error("Erreur lors du chargement des utilisateurs:",e)}},A=e=>{const s=JSON.parse(localStorage.getItem("user"));return s&&s.id===e},P=e=>a.createdBy&&a.createdBy.id===e,M=p&&["responsable_projet","manager"].includes(p);return(0,c.jsx)("div",{className:"modal-overlay",onClick:s,children:(0,c.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{className:"modal-header",children:[(0,c.jsx)("h2",{children:"G\xe9rer les utilisateurs du projet"}),(0,c.jsx)("button",{className:"modal-close",onClick:s,children:"\xd7"})]}),M&&(0,c.jsx)("div",{className:"modal-actions",children:(0,c.jsxs)("button",{className:"btn-add-user",onClick:()=>C(!v),children:[v?"\u2212":"+"," Ajouter un utilisateur"]})}),(0,c.jsxs)("div",{className:"modal-body",children:[m&&(0,c.jsx)("div",{className:"error-message",children:m}),h&&(0,c.jsx)("div",{className:"success-message",children:h}),v&&(0,c.jsxs)("div",{className:"add-user-section",children:[(0,c.jsx)("h3",{children:"Ajouter un nouvel utilisateur"}),(0,c.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),N.trim()){d(!0),u(null);try{const e=await k.dashboardServices.addUserToProject(a.id,N,b);r((s=>[...s,e.user])),g(""),S("collaborateur"),u(null)}catch(s){u(s.message||"Erreur lors de l'ajout de l'utilisateur")}finally{d(!1)}}},className:"add-user-form",children:[(0,c.jsxs)("div",{className:"form-group",style:{position:"relative"},children:[(0,c.jsx)("label",{htmlFor:"email",children:"Email de l'utilisateur *"}),(0,c.jsx)("input",{type:"email",id:"email",value:N,onChange:e=>{g(e.target.value),y(e.target.value.length>0)},placeholder:"exemple@email.com",required:!0}),T&&(0,c.jsx)("div",{className:"user-suggestions",children:w.filter((e=>e.email.toLowerCase().includes(N.toLowerCase())&&!o.some((s=>s.id===e.id)))).map((e=>(0,c.jsxs)("div",{className:"user-suggestion",onClick:()=>{return s=e.email,g(s),void y(!1);var s},children:[(0,c.jsxs)("span",{className:"user-name",children:[e.firstname," ",e.lastname]}),(0,c.jsx)("span",{className:"user-email",children:e.email})]},e.id)))}),(0,c.jsx)("small",{className:"form-help",children:"Tapez pour voir les suggestions d'utilisateurs"})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"role",children:"R\xf4le de l'utilisateur"}),(0,c.jsxs)("select",{id:"role",value:b,onChange:e=>S(e.target.value),className:"form-control",children:[(0,c.jsx)("option",{value:"collaborateur",children:"Collaborateur"}),(0,c.jsx)("option",{value:"responsable_projet",children:"Responsable de Projet"}),(0,c.jsx)("option",{value:"manager",children:"Manager"})]}),(0,c.jsx)("small",{className:"form-help",children:"Les administrateurs peuvent ajouter/supprimer des utilisateurs et modifier les r\xf4les"})]}),(0,c.jsxs)("div",{className:"form-actions",children:[(0,c.jsx)("button",{type:"submit",className:"btn-primary",disabled:i,children:i?"Ajout...":"Ajouter"}),(0,c.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>{C(!1),g(""),S("collaborateur")},children:"Annuler"})]})]})]}),(0,c.jsx)("div",{className:"users-list",children:o.length>0?o.map((e=>(0,c.jsxs)("div",{className:"user-item",children:[(0,c.jsxs)("div",{className:"user-info",children:[(0,c.jsxs)("div",{className:"user-name",children:[e.firstname," ",e.lastname]}),(0,c.jsx)("div",{className:"user-email",children:e.email}),(0,c.jsx)("div",{className:"user-role",children:(0,c.jsx)("span",{className:"role-badge role-".concat(e.role),children:"responsable_projet"===e.role?"Responsable de Projet":"manager"===e.role?"Manager":"Collaborateur"})})]}),M&&!A(e.id)&&!P(e.id)&&(0,c.jsxs)("div",{className:"user-actions",children:[(0,c.jsxs)("select",{value:e.role,onChange:s=>(async(e,s)=>{try{u(null),j(""),await k.dashboardServices.updateUserRole(a.id,e,s),r((a=>a.map((a=>a.id===e?(0,l.A)((0,l.A)({},a),{},{role:s}):a))));const t=o.find((s=>s.id===e));j("\u2705 R\xf4le de ".concat(null===t||void 0===t?void 0:t.firstname," ").concat(null===t||void 0===t?void 0:t.lastname," mis \xe0 jour avec succ\xe8s !")),setTimeout((()=>{j("")}),3e3)}catch(t){console.error("Erreur mise \xe0 jour r\xf4le:",t),u(t.message||"Erreur lors de la mise \xe0 jour du r\xf4le")}})(e.id,s.target.value),disabled:i,className:"role-select",children:[(0,c.jsx)("option",{value:"collaborateur",children:"Collaborateur"}),(0,c.jsx)("option",{value:"responsable_projet",children:"Responsable de Projet"}),(0,c.jsx)("option",{value:"manager",children:"Manager"})]}),(0,c.jsx)("button",{onClick:()=>(async e=>{try{await k.dashboardServices.removeUserFromProject(a.id,e),r((s=>s.filter((s=>s.id!==e))))}catch(s){u(s.message||"Erreur lors de la suppression de l'utilisateur")}})(e.id),disabled:i,className:"btn-remove-user",title:"Supprimer de ce projet",children:"\ud83d\uddd1\ufe0f"})]}),A(e.id)&&(0,c.jsx)("div",{className:"user-actions",children:(0,c.jsx)("span",{className:"current-user-badge",children:"Vous"})}),P(e.id)&&(0,c.jsx)("div",{className:"user-actions",children:(0,c.jsx)("span",{className:"creator-badge",children:"Cr\xe9ateur"})})]},e.id))):(0,c.jsx)("p",{className:"no-users",children:"Aucun utilisateur dans ce projet"})}),!M&&(0,c.jsx)("div",{className:"info-message",children:"Seuls les responsables de projet peuvent modifier les r\xf4les et supprimer des utilisateurs."})]}),(0,c.jsx)("div",{className:"modal-footer",children:(0,c.jsx)("button",{className:"btn-secondary",onClick:s,disabled:i,children:"Fermer"})})]})})},b=e=>{let{showCreateTask:s,setShowCreateTask:a,showCreateProject:l,setShowCreateProject:t,showCreateColumn:n,setShowCreateColumn:o,showEditTask:r,setShowEditTask:i,showManageUsers:d,setShowManageUsers:m,showDeleteProjectModal:u,setShowDeleteProjectModal:h,selectedTask:j,setSelectedTask:k,selectedProject:b,onCreateTask:S,onCreateProject:w,onCreateColumn:f,onUpdateTask:T,onUserUpdated:y,onDeleteProject:D}=e;return(0,c.jsxs)(c.Fragment,{children:[s&&(0,c.jsx)(p.A,{isOpen:s,onClose:()=>a(!1),onTaskCreated:S,projectId:null===b||void 0===b?void 0:b.id}),l&&(0,c.jsx)(v,{onClose:()=>t(!1),onCreateProject:w}),n&&(0,c.jsx)(N,{onClose:()=>o(!1),onCreateColumn:f}),r&&j&&(0,c.jsx)(x.A,{onClose:()=>{i(!1),k(null)},onTaskUpdate:T,task:j,project:b,mode:"edit"}),d&&(0,c.jsx)(g,{onClose:()=>m(!1),project:b,onUserUpdated:y}),u&&b&&(0,c.jsx)(C,{onClose:()=>h(!1),onConfirm:D,project:b})]})},S=e=>{let{onClose:s,onAddSkills:a,taskId:l}=e;const[n,o]=(0,t.useState)([]),[r,i]=(0,t.useState)([]),[d,m]=(0,t.useState)(!1),[u,h]=(0,t.useState)(null);(0,t.useEffect)((()=>{j()}),[]);const j=async()=>{try{const e=await k.dashboardServices.getSkills();o(e.skills)}catch(e){console.error("Erreur lors du chargement des comp\xe9tences:",e)}};return(0,c.jsx)("div",{className:"modal-overlay",onClick:s,children:(0,c.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{className:"modal-header",children:[(0,c.jsx)("h2",{children:"Ajouter des comp\xe9tences \xe0 la t\xe2che"}),(0,c.jsx)("button",{className:"btn-close",onClick:s,children:"\xd7"})]}),(0,c.jsxs)("form",{className:"modal-form",onSubmit:async e=>{if(e.preventDefault(),0!==r.length){m(!0),h(null);try{await k.dashboardServices.addSkillsToTask(l,r),a(r),s()}catch(t){h(t.message)}finally{m(!1)}}},children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{children:"S\xe9lectionner les comp\xe9tences requises"}),(0,c.jsx)("div",{className:"skills-list",children:n.map((e=>(0,c.jsxs)("label",{className:"skill-checkbox",children:[(0,c.jsx)("input",{type:"checkbox",checked:r.includes(e.id),onChange:()=>{return s=e.id,void i((e=>e.includes(s)?e.filter((e=>e!==s)):[...e,s]));var s}}),(0,c.jsx)("span",{className:"skill-name",children:e.name}),(0,c.jsxs)("span",{className:"skill-category",children:["(",e.category,")"]})]},e.id)))})]}),u&&(0,c.jsx)("div",{className:"error-message",children:(0,c.jsx)("p",{children:u})}),(0,c.jsxs)("div",{className:"modal-actions",children:[(0,c.jsx)("button",{type:"button",className:"btn-cancel",onClick:s,children:"Annuler"}),(0,c.jsx)("button",{type:"submit",className:"btn-create",disabled:d||0===r.length,children:d?"Ajout en cours...":"Ajouter ".concat(r.length," comp\xe9tence(s)")})]})]})]})})},w=e=>{let{isOpen:s,onClose:a,title:l,description:t}=e;return s?(0,c.jsx)("div",{className:"description-modal",onClick:a,children:(0,c.jsxs)("div",{className:"description-modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{className:"description-modal-header",children:[(0,c.jsx)("h3",{children:"Informations du projet"}),(0,c.jsx)("button",{className:"close-button",onClick:a,children:"\xd7"})]}),(0,c.jsxs)("div",{className:"project-info-content",children:[(0,c.jsxs)("div",{className:"info-section",children:[(0,c.jsx)("h4",{children:"Nom du projet"}),(0,c.jsx)("p",{className:"project-title",children:l})]}),t&&(0,c.jsxs)("div",{className:"info-section",children:[(0,c.jsx)("h4",{children:"Description"}),(0,c.jsx)("p",{className:"project-description",children:t})]})]})]})}):null},f=e=>{let{isOpen:s,onClose:a,columns:l,onSelectColumn:t}=e;return s?(0,c.jsx)("div",{className:"modal-overlay",onClick:a,children:(0,c.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{className:"modal-header",children:[(0,c.jsx)("h3",{children:"S\xe9lectionner une colonne \xe0 supprimer"}),(0,c.jsx)("button",{className:"btn-close",onClick:a,children:"\xd7"})]}),(0,c.jsxs)("div",{className:"modal-body",children:[(0,c.jsxs)("div",{className:"columns-selection",children:[(0,c.jsx)("p",{className:"selection-description",children:"Choisissez la colonne que vous souhaitez supprimer :"}),(0,c.jsx)("div",{className:"columns-list",children:l.map((e=>{var s;return(0,c.jsxs)("div",{className:"column-selection-item",onClick:()=>{t(e),a()},children:[(0,c.jsxs)("div",{className:"column-info",children:[(0,c.jsx)("div",{className:"column-color-indicator",style:{backgroundColor:e.color}}),(0,c.jsxs)("div",{className:"column-details",children:[(0,c.jsx)("h4",{children:e.name}),(0,c.jsx)("p",{children:e.description||"Aucune description"}),(0,c.jsxs)("small",{children:[(null===(s=e.tasks)||void 0===s?void 0:s.length)||0," t\xe2ches"]})]})]}),(0,c.jsx)("div",{className:"column-actions",children:(0,c.jsx)("button",{className:"btn-select-column",onClick:s=>{s.stopPropagation(),t(e),a()},children:"S\xe9lectionner"})})]},e.id)}))})]}),(0,c.jsx)("div",{className:"modal-actions",children:(0,c.jsx)("button",{className:"btn-cancel",onClick:a,children:"Annuler"})})]})]})}):null},T=e=>{let{isOpen:s,onClose:a,columns:l,onSelectColumn:t}=e;return s?(0,c.jsx)("div",{className:"modal-overlay",onClick:a,children:(0,c.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{className:"modal-header",children:[(0,c.jsx)("h3",{children:"S\xe9lectionner une colonne \xe0 modifier"}),(0,c.jsx)("button",{className:"btn-close",onClick:a,children:"\xd7"})]}),(0,c.jsxs)("div",{className:"modal-body",children:[(0,c.jsxs)("div",{className:"columns-selection",children:[(0,c.jsx)("p",{className:"selection-description",children:"Choisissez la colonne que vous souhaitez modifier :"}),(0,c.jsx)("div",{className:"columns-list",children:l.map((e=>{var s;return(0,c.jsxs)("div",{className:"column-selection-item",onClick:()=>{t(e),a()},children:[(0,c.jsxs)("div",{className:"column-info",children:[(0,c.jsx)("div",{className:"column-color-indicator",style:{backgroundColor:e.color}}),(0,c.jsxs)("div",{className:"column-details",children:[(0,c.jsx)("h4",{children:e.name}),(0,c.jsx)("p",{children:e.description||"Aucune description"}),(0,c.jsxs)("small",{children:[(null===(s=e.tasks)||void 0===s?void 0:s.length)||0," t\xe2ches"]})]})]}),(0,c.jsx)("div",{className:"column-actions",children:(0,c.jsx)("button",{className:"btn-select-column",onClick:s=>{s.stopPropagation(),t(e),a()},children:"S\xe9lectionner"})})]},e.id)}))})]}),(0,c.jsx)("div",{className:"modal-actions",children:(0,c.jsx)("button",{className:"btn-cancel",onClick:a,children:"Annuler"})})]})]})}):null},y=e=>{let{isOpen:s,onClose:a,column:l,onUpdateColumn:t}=e;if(!s||!l)return null;return(0,c.jsx)("div",{className:"modal-overlay",onClick:a,children:(0,c.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{className:"modal-header",children:[(0,c.jsx)("h3",{children:"Modifier la colonne"}),(0,c.jsx)("button",{className:"btn-close",onClick:a,children:"\xd7"})]}),(0,c.jsx)("div",{className:"modal-body",children:(0,c.jsxs)("form",{onSubmit:e=>{e.preventDefault();const s=new FormData(e.target);t(l.id,{name:s.get("name"),description:s.get("description"),color:s.get("color")})},children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"name",children:"Nom de la colonne"}),(0,c.jsx)("input",{type:"text",id:"name",name:"name",defaultValue:l.name,required:!0})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"description",children:"Description"}),(0,c.jsx)("textarea",{id:"description",name:"description",defaultValue:l.description,rows:"3"})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"color",children:"Couleur"}),(0,c.jsx)("input",{type:"color",id:"color",name:"color",defaultValue:l.color})]}),(0,c.jsxs)("div",{className:"modal-actions",children:[(0,c.jsx)("button",{type:"button",className:"btn-cancel",onClick:a,children:"Annuler"}),(0,c.jsx)("button",{type:"submit",className:"btn-confirm",children:"Modifier"})]})]})})]})})},D=e=>{let{showCreateTask:s,setShowCreateTask:a,showCreateProject:l,setShowCreateProject:t,showCreateColumn:n,setShowCreateColumn:o,showEditTask:r,setShowEditTask:i,showDeleteProjectModal:d,setShowDeleteProjectModal:m,showAddSkills:u,setShowAddSkills:h,showDeleteModal:j,setShowDeleteModal:p,showDeleteColumnModal:v,setShowDeleteColumnModal:C,showEditColumnModal:N,setShowEditColumnModal:k,showSelectColumnToDeleteModal:g,setShowSelectColumnToDeleteModal:D,showSelectColumnToEditModal:A,setShowSelectColumnToEditModal:P,showTaskDetailModal:M,setShowTaskDetailModal:E,showDescriptionModal:U,setShowDescriptionModal:R,selectedTask:O,setSelectedTask:F,selectedProject:q,taskToDelete:I,setTaskToDelete:z,columnToDelete:L,setColumnToDelete:V,columnToEdit:B,setColumnToEdit:_,selectedTaskForDetail:J,setSelectedTaskForDetail:G,columns:Z,currentUserRole:H,onCreateTask:K,onCreateProject:Q,onCreateColumn:W,onUpdateTask:X,onUserUpdated:Y,onDeleteProject:$,onDeleteTask:ee,handleUpdateColumn:se,handleTaskDetailUpdate:ae,fetchProjects:le}=e;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(b,{showCreateTask:s,setShowCreateTask:a,showCreateProject:l,setShowCreateProject:t,showCreateColumn:n,setShowCreateColumn:o,showEditTask:r,setShowEditTask:i,showManageUsers:!1,setShowManageUsers:()=>{},showDeleteProjectModal:d,setShowDeleteProjectModal:m,selectedTask:O,setSelectedTask:F,selectedProject:q,onCreateTask:K,onCreateProject:Q,onCreateColumn:W,onUpdateTask:X,onUserUpdated:Y,onDeleteProject:$}),u&&O&&(0,c.jsx)(S,{onClose:()=>{h(!1),F(null)},onAddSkills:e=>{h(!1),F(null)},taskId:O.id}),j&&I&&(0,c.jsx)("div",{className:"delete-modal-overlay",onClick:()=>p(!1),children:(0,c.jsxs)("div",{className:"delete-modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{className:"delete-modal-header",children:[(0,c.jsx)("h3",{children:"Confirmer la suppression"}),(0,c.jsx)("button",{className:"btn-close",onClick:()=>p(!1),children:"\xd7"})]}),(0,c.jsxs)("div",{className:"delete-modal-body",children:[(0,c.jsx)("p",{children:"\xcates-vous s\xfbr de vouloir supprimer la t\xe2che :"}),(0,c.jsxs)("p",{className:"task-title-confirm",children:['"',I.title,'" ?']}),(0,c.jsx)("p",{className:"delete-warning",children:"Cette action est irr\xe9versible."})]}),(0,c.jsxs)("div",{className:"delete-modal-actions",children:[(0,c.jsx)("button",{className:"btn-cancel",onClick:()=>p(!1),children:"Annuler"}),(0,c.jsx)("button",{className:"btn-confirm-delete",onClick:()=>{ee(I.id),p(!1),z(null)},children:"Supprimer la t\xe2che"})]})]})}),v&&L&&(0,c.jsx)("div",{className:"delete-modal-overlay",onClick:()=>C(!1),children:(0,c.jsxs)("div",{className:"delete-modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{className:"delete-modal-header",children:[(0,c.jsx)("h3",{children:"Confirmer la suppression de la colonne"}),(0,c.jsx)("button",{className:"btn-close",onClick:()=>C(!1),children:"\xd7"})]}),(0,c.jsxs)("div",{className:"delete-modal-body",children:[(0,c.jsx)("p",{children:"\xcates-vous s\xfbr de vouloir supprimer la colonne :"}),(0,c.jsxs)("p",{className:"task-title-confirm",children:['"',L.name,'" ?']}),(0,c.jsx)("p",{className:"delete-warning",children:"Cette action est irr\xe9versible."})]}),(0,c.jsxs)("div",{className:"delete-modal-actions",children:[(0,c.jsx)("button",{className:"btn-cancel",onClick:()=>C(!1),children:"Annuler"}),(0,c.jsx)("button",{className:"btn-confirm-delete",onClick:()=>{C(!1),V(null)},children:"Supprimer la colonne"})]})]})}),N&&B&&(0,c.jsx)(y,{isOpen:N,onClose:()=>{k(!1),_(null)},column:B,onUpdateColumn:se}),g&&(0,c.jsx)(f,{isOpen:g,onClose:()=>D(!1),columns:Z,onSelectColumn:e=>{V(e),D(!1),C(!0)}}),A&&(0,c.jsx)(T,{isOpen:A,onClose:()=>P(!1),columns:Z,onSelectColumn:e=>{_(e),P(!1),k(!0)}}),M&&J&&(0,c.jsx)(x.A,{task:J,isOpen:M,onClose:()=>{E(!1),G(null)},onTaskUpdate:ae,project:q,mode:"view",currentUserRole:H}),U&&q&&(0,c.jsx)(w,{isOpen:U,onClose:()=>R(!1),title:q.name,description:q.description})]})},A=e=>{let{isOpen:s,onClose:a}=e;const l=(0,n.Zp)();return s?(0,c.jsx)("div",{className:"modal-overlay",onClick:a,children:(0,c.jsxs)("div",{className:"modal-content upgrade-modal",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{className:"modal-header",children:[(0,c.jsx)("h2",{children:"\ud83d\ude80 Passez au Premium"}),(0,c.jsx)("button",{className:"btn-close",onClick:a,children:"\xd7"})]}),(0,c.jsxs)("div",{className:"upgrade-content",children:[(0,c.jsx)("div",{className:"upgrade-icon",children:(0,c.jsx)("span",{className:"icon",children:"\ud83d\udc8e"})}),(0,c.jsxs)("div",{className:"upgrade-message",children:[(0,c.jsx)("h3",{children:"Limite de 2 projets atteinte !"}),(0,c.jsx)("p",{children:"Vous avez atteint la limite de votre plan gratuit. Passez au plan Premium pour cr\xe9er des projets illimit\xe9s !"})]}),(0,c.jsxs)("div",{className:"premium-features",children:[(0,c.jsx)("h4",{children:"Plan Premium - 2.00\u20ac/mois"}),(0,c.jsxs)("ul",{children:[(0,c.jsx)("li",{children:"\u2705 Projets illimit\xe9s"}),(0,c.jsx)("li",{children:"\u2705 Fonctionnalit\xe9s avanc\xe9es"}),(0,c.jsx)("li",{children:"\u2705 Support prioritaire"}),(0,c.jsx)("li",{children:"\u2705 Rapports d\xe9taill\xe9s"})]})]}),(0,c.jsxs)("div",{className:"modal-actions",children:[(0,c.jsx)("button",{className:"btn-secondary",onClick:a,children:"Plus tard"}),(0,c.jsx)("button",{className:"btn-primary",onClick:()=>{a(),l("/upgrade")},children:"Passer au Premium"})]})]})]})}):null};a(189);const P=()=>{const[e,s]=(0,t.useState)([]),[a,d]=(0,t.useState)([]),[m,p]=(0,t.useState)([]),[x,v]=(0,t.useState)(null),[C,N]=(0,t.useState)(!0),[g,b]=(0,t.useState)(null),[S,w]=(0,t.useState)(!1),[f,T]=(0,t.useState)(!1),[y,P]=(0,t.useState)(!1),[M,E]=(0,t.useState)(!1),[U,R]=(0,t.useState)(!1),[O,F]=(0,t.useState)(null),[q,I]=(0,t.useState)(null),[z,L]=(0,t.useState)(!1),[V,B]=(0,t.useState)(null),[_,J]=(0,t.useState)(!1),[G,Z]=(0,t.useState)(!0),[H,K]=(0,t.useState)(!1),[Q,W]=(0,t.useState)(!1),[X,Y]=(0,t.useState)(null),[$,ee]=(0,t.useState)(!1),[se,ae]=(0,t.useState)(null),[le,te]=(0,t.useState)(!1),[ne,oe]=(0,t.useState)(!1),[re,ie]=(0,t.useState)(!1),[ce,de]=(0,t.useState)(!1),[me,ue]=(0,t.useState)(null),[he,je]=(0,t.useState)(!1),pe=((0,n.Zp)(),async()=>{try{const e=await k.dashboardServices.getProjects();d(e.projects),e.projects.length>0&&v(e.projects[0]),N(!1)}catch(e){b(e.message),N(!1)}}),xe=async e=>{try{const a=await k.dashboardServices.getTasks(e);s(a.tasks)}catch(a){b(a.message)}},ve=async e=>{try{const s=await k.dashboardServices.getColumns(e);p(s.columns)}catch(s){b(s.message)}},Ce=async e=>{try{await k.dashboardServices.deleteTask(e),s((s=>s.filter((s=>s.id!==e)))),L(!1),B(null)}catch(a){b(a.message)}};return(0,t.useEffect)((()=>{pe()}),[]),(0,t.useEffect)((()=>{if(x){const s=JSON.parse(localStorage.getItem("user"));if(s){var e;const a=null===(e=x.users)||void 0===e?void 0:e.find((e=>e.id===s.id)),l=null===a||void 0===a?void 0:a.role;I(l),i.A.setCurrentUserRole(l)}else I(null),i.A.setCurrentUserRole(null)}}),[x]),(0,t.useEffect)((()=>{x&&(xe(x.id),ve(x.id))}),[x]),(0,t.useEffect)((()=>{const e=e=>{le&&!e.target.closest(".column-actions-dropdown")&&te(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[le]),C?(0,c.jsxs)("div",{className:"dashboard-container",children:[(0,c.jsx)(o.A,{}),(0,c.jsxs)("div",{className:"loading-spinner",children:[(0,c.jsx)("div",{className:"spinner"}),(0,c.jsx)("p",{children:"Chargement du tableau..."})]}),(0,c.jsx)(r.A,{})]}):g?(0,c.jsxs)("div",{className:"dashboard-container",children:[(0,c.jsx)(o.A,{}),(0,c.jsxs)("div",{className:"error-container",children:[(0,c.jsx)("h2",{children:"Erreur"}),(0,c.jsx)("p",{children:g}),(0,c.jsx)("button",{onClick:()=>window.location.reload(),children:"R\xe9essayer"})]}),(0,c.jsx)(r.A,{})]}):(0,c.jsxs)("div",{className:"dashboard-container",children:[(0,c.jsx)(o.A,{}),(0,c.jsxs)("div",{className:"dashboard-layout",children:[(0,c.jsx)(j,{sidebarOpen:G,setSidebarOpen:Z,projects:a,selectedProject:x,setSelectedProject:v,setShowCreateProject:T,isCreator:e=>{const s=JSON.parse(localStorage.getItem("user"));return s&&e.createdBy&&e.createdBy.id===s.id}}),(0,c.jsxs)("div",{className:"main-content",children:[(0,c.jsx)(h,{selectedProject:x,currentUserRole:q,showColumnActionsMenu:le,setShowColumnActionsMenu:te,setShowCreateColumn:P,setShowSelectColumnToEditModal:ie,setShowSelectColumnToDeleteModal:oe,setShowDeleteProjectModal:J,setShowCreateTask:w,setShowDescriptionModal:je,handleAssignAllTasks:async()=>{if(x)try{const e=await k.dashboardServices.getProjectUsers(x.id);if(!e||0===e.length)return void b("Aucun collaborateur n'est ajout\xe9 \xe0 ce projet. Veuillez d'abord ajouter des utilisateurs au projet avant de pouvoir assigner des t\xe2ches automatiquement.");await k.dashboardServices.assignAllProjectTasks(x.id);await xe(x.id)}catch(e){b(e.message||"Erreur lors de l'assignation des t\xe2ches")}},isManager:e=>i.A.canAccessAdmin(e),canDeleteColumns:e=>i.A.canModifyTasks(e),canDeleteProject:e=>i.A.canManageProject(e),canCreateTasks:e=>i.A.canModifyTasks(e),canAssignTasks:e=>i.A.canAccessAdmin(e)}),x&&(0,c.jsx)(u,{columns:m,tasks:e,onUpdateTaskStatus:async(e,a)=>{try{await k.dashboardServices.updateTask(e,{status:a}),s((s=>s.map((s=>s.id===e?(0,l.A)((0,l.A)({},s),{},{status:a}):s))))}catch(t){b(t.message)}},onDeleteTask:Ce,onShowDeleteModal:e=>{B(e),L(!0)},onAddSkills:e=>{F(e),E(!0)},onEditTask:e=>{F(e),R(!0)},onAssignTask:async e=>{if(x)try{const a=await k.dashboardServices.getProjectUsers(x.id);if(!a||0===a.length)return void b("Aucun collaborateur n'est ajout\xe9 \xe0 ce projet. Veuillez d'abord ajouter des utilisateurs au projet avant de pouvoir assigner des t\xe2ches automatiquement.");const t=await k.dashboardServices.assignTaskAutomatically(e);s((s=>s.map((s=>s.id===e?(0,l.A)((0,l.A)({},s),{},{assignedTo:t.assignedTo}):s))))}catch(a){b(a.message||"Erreur lors de l'assignation de la t\xe2che")}},currentUserRole:q,onReorderColumns:async(e,s)=>{try{const a=[...m],t=a.findIndex((s=>s.id===e)),n=a.findIndex((e=>e.id===s));if(-1===t||-1===n)return;const[o]=a.splice(t,1);a.splice(n,0,o);const r=a.map(((e,s)=>(0,l.A)((0,l.A)({},e),{},{position:s})));p(r),await Promise.all(r.map((e=>k.dashboardServices.updateColumn(e.id,{position:e.position}))))}catch(a){b(a.message||"Erreur lors du r\xe9ordonnancement des colonnes"),x&&ve(x.id)}},onShowTaskDetail:e=>{ue(e),de(!0)}})]})]}),(0,c.jsx)(D,{showCreateTask:S,setShowCreateTask:w,showCreateProject:f,setShowCreateProject:T,showCreateColumn:y,setShowCreateColumn:P,showEditTask:U,setShowEditTask:R,showDeleteProjectModal:_,setShowDeleteProjectModal:J,showAddSkills:M,setShowAddSkills:E,showDeleteModal:z,setShowDeleteModal:L,showDeleteColumnModal:H,setShowDeleteColumnModal:K,showEditColumnModal:$,setShowEditColumnModal:ee,showSelectColumnToDeleteModal:ne,setShowSelectColumnToDeleteModal:oe,showSelectColumnToEditModal:re,setShowSelectColumnToEditModal:ie,showTaskDetailModal:ce,setShowTaskDetailModal:de,showDescriptionModal:he,setShowDescriptionModal:je,selectedTask:O,setSelectedTask:F,selectedProject:x,taskToDelete:V,setTaskToDelete:B,columnToDelete:X,setColumnToDelete:Y,columnToEdit:se,setColumnToEdit:ae,selectedTaskForDetail:me,setSelectedTaskForDetail:ue,columns:m,currentUserRole:q,onCreateTask:async e=>{try{s((s=>[...s,e])),w(!1)}catch(a){b(a.message)}},onCreateProject:async e=>{try{const s=await k.dashboardServices.createProject(e);d((e=>[...e,s.project])),v(s.project),T(!1)}catch(s){if(403===s.status)return W(!0),void T(!1);b(s.message||"Erreur lors de la cr\xe9ation du projet")}},onCreateColumn:async e=>{try{const s=await k.dashboardServices.createColumn((0,l.A)((0,l.A)({},e),{},{projectId:x.id}));p((e=>[...e,s.column])),P(!1)}catch(s){b(s.message)}},onUpdateTask:async(e,s)=>{try{await k.dashboardServices.updateTask(e,s);await xe(x.id),R(!1),F(null)}catch(a){b(a.message)}},onUserUpdated:()=>pe(),onDeleteProject:async()=>{try{await k.dashboardServices.deleteProject(x.id),d((e=>e.filter((e=>e.id!==x.id)))),v(null),J(!1)}catch(e){b(e.message||"Erreur lors de la suppression du projet")}},onDeleteTask:Ce,handleUpdateColumn:async(e,s)=>{try{const a=await k.dashboardServices.updateColumn(e,s);p((s=>s.map((s=>s.id===e?(0,l.A)((0,l.A)({},s),a.column):s)))),ee(!1),ae(null)}catch(a){b(a.message||"Erreur lors de la mise \xe0 jour de la colonne")}},handleTaskDetailUpdate:async()=>{if(x&&(await xe(x.id),await ve(x.id),me)){const e=await k.dashboardServices.getTasks(x.id);if(e&&Array.isArray(e)){const s=e.find((e=>e.id===me.id));s&&ue(s)}}},fetchProjects:pe}),(0,c.jsx)(A,{isOpen:Q,onClose:()=>W(!1)}),(0,c.jsx)(r.A,{})]})}},850:(e,s,a)=>{e.exports=a.p+"static/media/fleche-droite.6ea1a55283692578cf86.png"}}]);
//# sourceMappingURL=637.29ea9e6b.chunk.js.map